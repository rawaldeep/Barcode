<!DOCTYPE html>
<html>
<head>
  <title>Barcode Scanner</title>
  <style>
    video {
      width: 100%;
      max-width: 500px;
    }
  </style>
</head>
<body>
  <h1>Barcode Scanner</h1>
  <video id="video" autoplay></video>
  <p id="result"></p>

  <script>
    // Check if the Barcode Detection API is supported
    if ('BarcodeDetector' in window) {
      // Get the video element and set up the camera stream
      const video = document.getElementById('video');
      navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } })
        .then(stream => {
          video.srcObject = stream;
          video.play();

          // Create a new BarcodeDetector instance
          const barcodeDetector = new window.BarcodeDetector({ formats: ['qr_code', 'code_128'] });

          // Scan for barcodes every frame
          const scanBarcodes = async () => {
            try {
              const barcodes = await barcodeDetector.detect(video);
              const result = document.getElementById('result');
              if (barcodes.length > 0) {
                result.textContent = `Barcode detected: ${barcodes[0].rawValue}`;
              } else {
                result.textContent = 'No barcode detected';
              }
            } catch (error) {
              console.error('Barcode detection failed:', error);
            }
            requestAnimationFrame(scanBarcodes);
          };

          scanBarcodes();
        })
        .catch(error => {
          console.error('Failed to access camera:', error);
        });
    } else {
      console.error('Barcode Detection API is not supported');
    }
  </script>
</body>
</html>